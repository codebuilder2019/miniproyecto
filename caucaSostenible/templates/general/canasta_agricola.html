{% extends "general/layout.html" %}
{% load static %}

{% block body %}
<div id="main-container">
    <h1>
        <center>Canasta Agricola</center>
    </h1>
    <div class="form-row">
        {% for product in products %}
        <div class="col-12 col-sm-4 col-lg-2 p-2">
            <article class="card h-100 bg-sucess">
                <center>
                    <h3 class="title">{{product.name}}</h3>
                    <img id="product_img" src="{{product.imgURL}}" class="img-fluid" style="max-height: 100px;" alt="">
                    <p><b>Cantidad:</b>{{product.description}}</p>
                    <p>Descuento: {{product.discount}}</p>
                    <p>Precio: {{product.price}}</p>
                    <br>
                    <button class="common-button" onclick="addProduct()">Agregar al Carrito</button>                   
            </article>
        </div>
        {% endfor %}
    </div> 
</div>
<script>
    function addProduct () {
            fetch('/cart/set_product_quantity/' + '{{ product.id }}/1')
                .then(response => response.json())
                .then(data => {
                    renderProductQuantity("{{ product.id }}", data)
                });
        }
        function renderProductQuantity (productId, data) {
            document.getElementById("addProductButton").style.display = "none";           
            document.getElementById("acceptedQuantity").innerHTML = data.addedItems + ' items added';
            document.getElementById("quantity_" + productId).value = data.addedItems;
            document.getElementById("updateQuantitySection").style.display = "block";
        }
</script>
{% endblock %}